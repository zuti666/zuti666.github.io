---
layout: post
title:  Finsherä¿¡æ¯çŸ©é˜µ
categories: math MachineLearning
description: 
keywords: math MachineLearning
---





# Finsherä¿¡æ¯çŸ©é˜µ



åœ¨æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ ä¸­çš„ç›®æ ‡é€šå¸¸æ˜¯æ‰¾åˆ°ä¸€ç»„æœ€ä¼˜å‚æ•° $\theta^*$ä½¿å¾—æ¨¡å‹$f_\theta(X)$åœ¨ æ•°æ®é›†$D$ä¸Šçš„è¡¨ç°æœ€ä½³ã€‚è€Œåœ¨æ¦‚ç‡ç»Ÿè®¡çš„æ¡†æ¶ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨**æœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼ˆMaximum Likelihood Estimation, MLEï¼‰**æ¥æè¿°è¿™ä¸ªä¼˜åŒ–è¿‡ç¨‹

## æœ€å¤§ä¼¼ç„¶ä¼°è®¡ MLE

åœ¨ç»Ÿè®¡å»ºæ¨¡ä¸­ï¼Œæˆ‘ä»¬å‡è®¾æ•°æ® $D$ ç”±æŸä¸ªæ¦‚ç‡åˆ†å¸ƒç”Ÿæˆï¼Œè¯¥åˆ†å¸ƒçš„å‚æ•°ç”± $\theta$ æ§åˆ¶ã€‚

å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—**æ•°æ®åœ¨ç»™å®šå‚æ•°ä¸‹çš„æ¦‚ç‡**ï¼Œå³ **ä¼¼ç„¶å‡½æ•° (Likelihood function)**ï¼š
$$
\ell(\theta) = p(D | \theta)
$$
å¯¹æ•°ä¼¼ç„¶å‡½æ•° $\ell(\theta^*)$ å®šä¹‰ä¸ºè§‚å¯Ÿåˆ°çš„æ•°æ®çš„å¯¹æ•°æ¦‚ç‡ï¼Œå®ƒæ˜¯å…³äºå‚æ•°$\theta$ çš„å‡½æ•°

**æœ€å¤§ä¼¼ç„¶ä¼°è®¡ (MLE) çš„ç›®æ ‡**æ˜¯æ‰¾åˆ°æœ€ä¼˜å‚æ•° $\theta^*$ï¼Œä½¿å¾— $\ell(\theta)=p(D | \theta)$ æœ€å¤§åŒ–ï¼š
$$
\theta^* =  \arg\max_{\theta} \ell(\theta)=\arg\max_{\theta} p(D | \theta) 
$$


å½“æˆ‘ä»¬æ‰¾åˆ° $\theta^*$ åï¼Œå®ƒçš„å¯é ç¨‹åº¦å¦‚ä½•ï¼Ÿæˆ‘ä»¬å¯¹è¿™ä¸ªä¼°è®¡å€¼æœ‰å¤šå¤§ä¿¡å¿ƒï¼Ÿ

## 2  äºŒé˜¶æ³°å‹’å±•å¼€

åœ¨ç»Ÿè®¡ä¸­ï¼Œæˆ‘ä»¬ç”¨ **å‚æ•°çš„ä¸ç¡®å®šæ€§ï¼ˆuncertaintyï¼‰** æ¥è¡¨ç¤ºä¼°è®¡å€¼æ˜¯å¦ç¨³å®šã€‚ä¹Ÿå°±æ˜¯å½“ä¼°è®¡å€¼$\theta^*$å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œå…¶å¯¹åº”çš„ä¼¼ç„¶å‡½æ•°çš„å€¼çš„å˜åŒ–ä¼šæœ‰å¤šå¤§ï¼ˆä¹Ÿå°±æ˜¯æ¢¯åº¦æˆ–è€…æ–¹å·®çš„æ¦‚å¿µï¼‰ã€‚

![image-20250330175118608](https://zuti.oss-cn-qingdao.aliyuncs.com/img/20250330175118664.png)



æˆ‘ä»¬å¯ä»¥ä»äºŒé˜¶å¯¼æ•°ï¼ˆå³**Hessian çŸ©é˜µ**ï¼‰çš„è§’åº¦å»ç†è§£è¿™ä¸ªé—®é¢˜ã€‚

è®¾ $\ell(\theta)$ ä¸ºå¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼Œæˆ‘ä»¬åœ¨ $\theta^*$ ç‚¹å¯¹å…¶è¿›è¡ŒäºŒé˜¶æ³°å‹’å±•å¼€ï¼š
$$
\begin{aligned}
\ell(\theta)
 & \approx \ell(\theta^*) +\frac{\partial \ell}{\partial \theta} \bigg|_{\theta=\theta^*}(\theta-\theta^*) + \frac{1}{2}\frac{\partial^2 \ell}{\partial \theta^2} \bigg|_{\theta=\theta^*}(\theta-\theta^*)^2 \\



& \approx 

\ell(\theta^*) 

+ \frac{1}{2} (\theta - \theta^*)^\top H (\theta - \theta^*)

\end{aligned}
$$
å…¶ä¸­ $H$ æ˜¯å¯¹æ•°ä¼¼ç„¶å‡½æ•°çš„HessiançŸ©é˜µï¼š
$$
H =  \nabla^2 \ell(\theta) \bigg|_{\theta = \theta^*}
$$


åœ¨ä¸Šé¢æ¨å¯¼ä¸­ï¼Œç”±äº $\theta^*$ æ˜¯æœ€ä¼˜ç‚¹ï¼Œæ‰€ä»¥å…¶ä¸€é˜¶å¯¼æ•°ä¸º0ï¼Œå°±åªå‰©ä¸‹äº†äºŒé˜¶å¯¼æ•°ã€‚

> æ¨å¯¼è¯æ˜ åœ¨ $\theta^*$å¤„ï¼Œä¸€é˜¶å¯¼æ•°çš„æœŸæœ›å€¼ä¸º0ï¼š
>
> ä¸ºäº†æœ€å¤§åŒ–å¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼Œé€šå¸¸ä½¿ç”¨ä»¤æ¢¯åº¦ç­‰äº 0 çš„æ–¹æ³•ã€‚æ¢¯åº¦æ˜¯å¯¹æ•°ä¼¼ç„¶å‡½æ•°å…³äºå‚æ•°$\theta$ çš„åå¯¼æ•°ã€‚è¿™ä¸ªåå¯¼æ•°è¢«ç§°ä¸º "Score function"ï¼ˆå¾—åˆ†å‡½æ•°ï¼‰ï¼Œé€šå¸¸è®°ä½œ $U(\theta) $æˆ– $\frac{\partial \ell}{\partial \theta} $ã€‚
>
> ###  å¾—åˆ†å‡½æ•°(Score function)
>
> å¾—åˆ†å‡½æ•°ï¼ˆScore functionï¼‰ä¸ºå¯¹æ•°ä¼¼ç„¶å‡½æ•°å…³äºå‚æ•°çš„ä¸€é˜¶å¯¼æ•°ã€‚è¡¨ç¤ºä¸º:
> $$
> U(\theta) =\frac{\partial \ell}{\partial \theta} = \nabla_{\theta} \log â¡p(x|\theta)
> $$
> åœ¨æœ€å¤§åŒ–å¯¹æ•°ä¼¼ç„¶å‡½æ•°æ—¶ï¼Œå¾—åˆ†å‡½æ•°å‘Šè¯‰æˆ‘ä»¬åœ¨å½“å‰å‚æ•°å€¼ä¸‹ï¼Œå¢åŠ æˆ–å‡å°‘ä¸€ä¸ªå•ä½çš„å‚æ•°å€¼ä¼šå¯¹å¯¹æ•°ä¼¼ç„¶å‡½æ•°äº§ç”Ÿå¤šå¤§çš„å˜åŒ–ã€‚é€šå¸¸ï¼Œé€šè¿‡å°†å¾—åˆ†å‡½æ•°è®¾ç½®ä¸ºé›¶æ¥æ‰¾åˆ°å¯¹æ•°ä¼¼ç„¶å‡½æ•°çš„æœ€å¤§å€¼ã€‚
>
> **å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸€æ–¹é¢ï¼Œå¯¹äºä¸€ä¸ªç¡®å®šçš„å¾—åˆ†å‡½æ•°ï¼Œå®ƒæ˜¯ä¸€ä¸ªå…³äº Î¸ çš„å‡½æ•°ï¼›å¦ä¸€æ–¹é¢ï¼Œå¯¹äºå¾—åˆ†å‡½æ•°æœ¬èº«ï¼Œå®ƒæ˜¯ä¸€ä¸ªå…³äº x ï¼ˆè§‚æµ‹åˆ°çš„æ•°æ®ç‚¹ï¼‰çš„å‡½æ•°ï¼Œå› ä¸ºæ¯ç»™ x ä¸€ä¸ªå€¼ï¼Œéƒ½ç­‰å¾—åˆ°ä¸ä¹‹å¯¹åº”çš„å¾—åˆ†å‡½æ•°ã€‚**
>
> ä¸‹é¢æˆ‘ä»¬æŠŠ $x$ ä½œä¸ºè‡ªå˜é‡ï¼Œå¾—åˆ†å‡½æ•°ä½œä¸ºå› å˜é‡ã€‚å³æœ‰æ˜ å°„ï¼šè§‚æµ‹æ•°æ® $x$ â†’ å¾—åˆ†å‡½æ•° $U(\theta)$
>
> **æ€§è´¨ï¼šå‡è®¾ $\theta$ çš„çœŸå®å€¼ä¸º** $\theta_0$ ï¼Œé‚£ä¹ˆ**å¾—åˆ†å‡½æ•°çš„æœŸæœ›å‡½æ•°åœ¨ $\theta_0$ å¤„çš„å€¼ä¸º $0$ã€‚å³**
> $$
> E[U(\theta, x)] \bigg|_{\theta=\theta_0} = 0
> $$
> è¯æ˜ï¼š
> $$
> \begin{aligned}
> E[U(\theta, x)] & =\int_{-\infty}^{+\infty} U(\theta, x) p\left(x \mid \theta_0\right) d x \\
> & =\int_{-\infty}^{+\infty} \nabla_\theta \log p(x \mid \theta) p\left(x \mid \theta_0\right) d x \\
> & =\int_{-\infty}^{+\infty} \frac{\nabla_\theta p(x \mid \theta)}{p(x \mid \theta)} p\left(x \mid \theta_0\right) d x \\
> \left.E[U(\theta, x)]\right|_{\theta=\theta_0} & =\int_{-\infty}^{+\infty} \frac{\nabla_\theta p(x \mid \theta)}{p\left(x \mid \theta_0\right)} p\left(x \mid \theta_0\right) d x \\
> & =\int_{-\infty}^{+\infty} \nabla_\theta p(x \mid \theta) d x \\
> & =\nabla_\theta \int_{-\infty}^{+\infty} p(x \mid \theta) d x \\
> & =\nabla 1 \\
> & =0
> \end{aligned}
> $$
> 



å¯¹äºäºŒé˜¶å¯¼æ•°ï¼Œæˆ‘ä»¬é™¤äº†æœ‰HessiançŸ©é˜µçš„å®šä¹‰ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å°†å…¶å®šä¹‰ä¸ºFinsherä¿¡æ¯çŸ©é˜µå¦‚ä¸‹ï¼š

å¯¹äºäºŒé˜¶å¯¼æ•°
$$
\frac{\partial^2 \ell}{\partial \theta^2}
$$
å¯¹äºä¼¼ç„¶å‡½æ•°$\ell$ æˆ‘ä»¬æ›´å–œæ¬¢ç”¨å®ƒçš„å¯¹æ•°å½¢å¼ ï¼Œå¯¹æ•°ä¼¼ç„¶å‡½æ•° $\log \ell$ ,äºæ˜¯å¯ä»¥å†™ä½œ
$$
\frac{\partial^2 \log \ell }{\partial \theta^2}
$$
æˆ‘ä»¬å¯ä»¥å°†å…¶æ›´åŠ æ³›åŒ–åˆ°å¤šå‚æ•°çš„ç©ºé—´ï¼Œæˆ‘ä»¬æœ‰
$$
\frac{\partial \log \ell}{\partial \theta_\alpha}  \frac{\partial \log \ell}{\partial \theta_\beta} = -F
$$
ä¸Šé¢çš„ F å°±æ˜¯ Finsherä¿¡æ¯çŸ©é˜µ 

## Finsher ä¿¡æ¯çŸ©é˜µå®šä¹‰

è®¾æ•°æ® $x$ æ¥è‡ªæŸä¸ªåˆ†å¸ƒ $p(x | \theta)$ï¼Œå¯¹æ•°ä¼¼ç„¶å‡½æ•°ä¸ºï¼š
$$
\ell(\theta) = \log p(x | \theta)
$$
**Fisher ä¿¡æ¯çŸ©é˜µ $F(\theta)$ æœ‰ä¸¤ç§ç­‰ä»·å®šä¹‰ï¼š**

### âœ… å®šä¹‰ä¸€ï¼ˆæ¢¯åº¦å¤–ç§¯çš„æœŸæœ›ï¼‰ï¼š

$$
F(\theta) := \mathbb{E}_{x \sim p(x|\theta)} \left[ \nabla \log p(x | \theta) \cdot \nabla \log p(x | \theta)^\top \right]
$$

è¿™å°±æ˜¯ç»å…¸çš„ **æœŸæœ›å½¢å¼**ï¼Œæœ¬è´¨ä¸Šæ˜¯æ¢¯åº¦çš„æ–¹å·®ï¼š

> Fisher ä¿¡æ¯ = ä¼¼ç„¶å‡½æ•°æ¢¯åº¦çš„äºŒé˜¶åŠ¨å·®ï¼ˆåæ–¹å·®ï¼‰







å®ƒä¹Ÿå¯ä»¥è§†ä¸ºè´ŸäºŒé˜¶å¯¼æ•°çš„æœŸæœ›å€¼ï¼š

### âœ… å®šä¹‰äºŒï¼ˆè´ŸäºŒé˜¶å¯¼çš„æœŸæœ›ï¼‰ï¼š

$$
F(\theta) := - \mathbb{E}_{x \sim p(x|\theta)} \left[ \nabla^2 \log p(x | \theta) \right] =  -\mathbb{E}[H_{\log p(x|\theta)}]
$$

ä¸¤ç§å½¢å¼åœ¨æ­£åˆ™æ¡ä»¶ä¸‹æ˜¯ç­‰ä»·çš„ã€‚

## ä¸¤ç§å®šä¹‰çš„ç­‰ä»·æ¨å¯¼

###  ğŸ“˜ æ­¥éª¤ 1ï¼šåˆ©ç”¨æ¦‚ç‡çš„æ€§è´¨

æˆ‘ä»¬çŸ¥é“å¯¹æ‰€æœ‰ $x$ï¼Œæ¦‚ç‡å¯†åº¦ç§¯åˆ†ä¸º 1ï¼š
$$
\int p(x|\theta) dx = 1
$$
å¯¹ä¸Šå¼ä¸¤è¾¹å¯¹ $\theta$ æ±‚å¯¼ï¼š
$$
\frac{\partial}{\partial \theta} \int p(x|\theta) dx = \int \frac{\partial p(x|\theta)}{\partial \theta} dx = 0
$$
å†å¯¹ $\theta$ æ±‚ä¸€æ¬¡å¯¼æ•°ï¼š
$$
\frac{\partial^2}{\partial \theta^2} \int p(x|\theta) dx = \int \frac{\partial^2 p(x|\theta)}{\partial \theta^2} dx = 0
$$
è¿™æ˜¯åé¢å°†ç”¨åˆ°çš„ **æ­£è§„åŒ–æ¡ä»¶**ã€‚

### ğŸ“˜ æ­¥éª¤ 2ï¼šå¯¹æ¢¯åº¦å¤–ç§¯å½¢å¼è¿›è¡Œåˆ†æ

æˆ‘ä»¬å°†å¯¹æ•°ä¼¼ç„¶æ¢¯åº¦å¹³æ–¹é¡¹å±•å¼€æœŸæœ›ï¼š
$$
\mathbb{E}_{x \sim p(x|\theta)} \left[ \nabla_\theta \log p(x|\theta) \cdot \nabla_\theta \log p(x|\theta)^\top \right]
$$
æ³¨æ„ï¼š

$\nabla_\theta \log p(x|\theta) = \frac{\nabla_\theta p(x|\theta)}{p(x|\theta)}$

å› æ­¤ï¼š
$$
\mathbb{E} \left[ \nabla \log p(x|\theta) \nabla \log p(x|\theta)^\top \right] = \int p(x|\theta) \cdot \left( \frac{\nabla_\theta p(x|\theta)}{p(x|\theta)} \right) \left( \frac{\nabla_\theta p(x|\theta)}{p(x|\theta)} \right)^\top dx
$$
ç®€åŒ–å¾—ï¼š
$$
\int \frac{\nabla_\theta p(x|\theta) \nabla_\theta p(x|\theta)^\top}{p(x|\theta)} dx
$$
è¿™å°±æ˜¯ **æ¢¯åº¦å¹³æ–¹é¡¹çš„æœŸæœ›**ã€‚

### ğŸ“˜ æ­¥éª¤ 3ï¼šå¯¹è´ŸäºŒé˜¶å¯¼æ•°å½¢å¼è¿›è¡Œåˆ†æ

è€ƒè™‘å¯¹ $\log p(x|\theta)$ çš„ Hessianï¼š
$$
\nabla^2 \log p(x|\theta) = \frac{\nabla^2 p(x|\theta)}{p(x|\theta)} - \frac{\nabla p(x|\theta) \nabla p(x|\theta)^\top}{p(x|\theta)^2}
$$
å› æ­¤ï¼š
$$
- \nabla^2 \log p(x|\theta) = - \frac{\nabla^2 p(x|\theta)}{p(x|\theta)} + \frac{\nabla p(x|\theta) \nabla p(x|\theta)^\top}{p(x|\theta)^2}
$$
ä¸¤è¾¹å¯¹ $x$ ç§¯åˆ†å–æœŸæœ›ï¼š
$$
- \mathbb{E} \left[ \nabla^2 \log p(x|\theta) \right] = - \int \frac{\nabla^2 p(x|\theta)}{p(x|\theta)} p(x|\theta) dx + \int \frac{\nabla p(x|\theta) \nabla p(x|\theta)^\top}{p(x|\theta)^2} p(x|\theta) dx
$$
æ ¹æ®å‰é¢çš„æ­£è§„åŒ–æ¡ä»¶,ç¬¬ä¸€ä¸ªé¡¹åŒ–ç®€ä¸ºï¼š

$- \int \nabla^2 p(x|\theta) dx = 0$

äºæ˜¯æˆ‘ä»¬åªå‰©ä¸‹ç¬¬äºŒé¡¹ï¼š

$\mathbb{E} \left[ \nabla \log p(x|\theta) \nabla \log p(x|\theta)^\top \right]$

äºæ˜¯æœ‰
$$
- \mathbb{E} \left[ \nabla^2 \log p(x|\theta) \right] = \mathbb{E} \left[ \nabla \log p(x|\theta) \nabla \log p(x|\theta)^\top \right]
$$
âœ… è¿™å°±è¯æ˜äº†ä¸¤ç§ Fisher ä¿¡æ¯å®šä¹‰æ˜¯ç­‰ä»·çš„ï¼



##  Finsher ä¿¡æ¯çŸ©é˜µä¸ Hessian çŸ©é˜µçš„å…³ç³»

| ç‰¹æ€§       | Hessian çŸ©é˜µ            | Fisher ä¿¡æ¯çŸ©é˜µ                                              |
| ---------- | ----------------------- | ------------------------------------------------------------ |
| è¡¨è¾¾å¼     | $\nabla^2 \ell(\theta)$ | $- \mathbb{E}_{x \sim p(x|\theta)} \left[ \nabla^2 \log p(x |\theta) \right]$ |
| éšæ•°æ®æ³¢åŠ¨ | æ˜¯ï¼ˆä¾èµ–æ ·æœ¬ï¼‰          | å¦ï¼ˆå–æœŸæœ›ï¼‰                                                 |
| æ­£å®šæ€§     | ä¸ä¸€å®š                  | æ’ä¸ºåŠæ­£å®š                                                   |
| ç¨³å®šæ€§     | å¯èƒ½å™ªå£°å¤§              | æ›´å¹³æ»‘ç¨³å¥                                                   |
| åº”ç”¨       | è´å¶æ–¯è¿‘ä¼¼ä¸­çš„ Laplace  | è‡ªç„¶æ¢¯åº¦ã€EWCã€å˜åˆ†æ¨æ–­ç­‰                                    |

> ç»“è®ºï¼š**Fisher ä¿¡æ¯æ˜¯ Hessian çš„è¿‘ä¼¼æœŸæœ›å½¢å¼ï¼Œæ›´å®¹æ˜“ä¼°è®¡ï¼Œä¹Ÿæ›´ç¨³å®šã€‚**

## Finsherä¿¡æ¯çŸ©é˜µä¸åæ–¹å·®çŸ©é˜µ

æ–¹å·®è¡¨ç¤ºéšæœºå˜æ˜¾åç¦»å‡å€¼çš„ç¨‹åº¦ã€‚éšæœºå˜é‡ $X$ çš„æ–¹å·®è¡¨ç¤ºä¸º

$$
\begin{aligned}
\operatorname{Var}(X) & =E\left[(X-E(X))^2\right] \\
& =E\left(X^2\right)-E(X)^2
\end{aligned}
$$


åæ–¹å·®æ˜¯æ–¹å·®æ¦‚å¿µçš„å»¶ç”³ã€‚éšæœºå˜é‡ $X$ å’Œéšæœºå˜é‡ $Y$ çš„åæ–¹å·®è¡¨ç¤ºä¸º $X$ çš„åå·® $X-E(X)$ ä¸ $Y$ çš„åå·® $Y-E(Y)$ ä¹˜ç§¯çš„æ•°å­¦æœŸæœ›ã€‚

$$
\begin{aligned}
\operatorname{Cov}(X, Y) & =E[(X-E(X))(Y-E(Y))] \\
& =E(X Y)-E(X) E(Y)
\end{aligned}
$$


è®° $n$ ç»´éšæœºå˜é‡ä¸º $X=\left(x_1, x_2, \ldots, x_n\right)^{\prime}$ ï¼Œè‹¥å…¶æ¯ä¸ªåˆ†é‡çš„æ•°å­¦æœŸæœ›éƒ½å­˜åœ¨ï¼Œåˆ™ $X$ çš„æœŸæœ›ä¸º

$$
E(X)=\left(E\left(X_1\right), E\left(x_2\right), \ldots, E\left(X_n\right)\right)^{\prime}
$$

$X$ çš„æ–¹å·®ï¼åæ–¹å·®çŸ©é˜µä¸º

$$
\begin{aligned}
\operatorname{Cov}(X) & =E\left[(X-E(X))(X-E(X))^{\prime}\right] \\
& =E\left(X X^{\prime}\right)-E(X) E(X)^{\prime} \\
& =\left[\begin{array}{cccc}
\operatorname{Var}\left(X_1\right) & \operatorname{Cov}\left(X_1, X_n\right) & \cdots & \operatorname{Cov}\left(X_1, X_n\right) \\
\operatorname{Cov}\left(X_2, X_1\right) & \operatorname{Var}\left(X_2\right) & \cdots & \operatorname{Cov}\left(X_2, X n\right) \\
\vdots & \vdots & \ddots & \vdots \\
\operatorname{Cov}\left(X_n, X_1\right) & \operatorname{Cov}\left(X_n, X_2\right) & \cdots & \operatorname{Var}\left(X_n\right)
\end{array}\right]
\end{aligned}
$$

 åœ¨ $ \theta=\theta_0$ æ—¶ï¼ŒFinsherä¿¡æ¯çŸ©é˜µ$F$å°±æ˜¯å¾—åˆ†å‡½æ•°$U(\theta)$çš„åæ–¹å·®çŸ©é˜µã€‚ 
$$
\begin{aligned}
& E\left[\left(U(\theta, x)-\left.E(U(\theta, x))\left(U(\theta, x)-E(U(\theta, x))^{\prime}\right]\right|_{\theta=\theta_0}\right.\right. \\
= & \left.E\left[U(\theta, x) U(\theta, x)^{\prime}\right]\right|_{\theta=\theta_0}-\left.E(U(\theta, x)) E(U(\theta, x))^{\prime}\right|_{\theta=\theta_0} \\
= & \left.E\left[U(x \mid \theta) U(x \mid \theta)^{\prime}\right]\right|_{\theta=\theta_0}-0 \\
= & \left.E\left[U(x \mid \theta) U(x \mid \theta)^{\prime}\right]\right|_{\theta=\theta_0} \\
= & F\left(\theta_0\right)
\end{aligned}
$$


## Finsheä¿¡æ¯çŸ©é˜µä¸è´å¶æ–¯ä¼°è®¡çš„å…³ç³»

åœ¨è´å¶æ–¯ä¼°è®¡ä¸­ï¼Œæˆ‘ä»¬ä¸ä»…æœ€å¤§åŒ–ä¼¼ç„¶ $p(D|\theta)$ï¼Œè¿˜è€ƒè™‘å…ˆéªŒåˆ†å¸ƒ $p(\theta)$ï¼š
$$
\log p(\theta | D) = \log p(D | \theta) + \log p(\theta) + C
$$
äºæ˜¯æˆ‘ä»¬æœ€å¤§åŒ– **å¯¹æ•°åéªŒï¼ˆLog-Posteriorï¼‰**ï¼š
$$
\theta^*_{\text{MAP}} = \arg\max_\theta \log p(D | \theta) + \log p(\theta)
$$
æ‹‰æ™®æ‹‰æ–¯è¿‘ä¼¼ä¸‹ï¼Œæˆ‘ä»¬å¯¹ $\log p(\theta | D)$ è¿›è¡ŒäºŒé˜¶å±•å¼€ï¼Œè¿‘ä¼¼ä¸ºé«˜æ–¯ï¼š
$$
p(\theta | D) \approx \mathcal{N}(\theta^*_{\text{MAP}}, \Sigma)
$$
å…¶ä¸­ï¼š
$$
\Sigma^{-1} = - \nabla^2 \log p(\theta | D) \Big|_{\theta = \theta^*_{\text{MAP}}}
$$
**åœ¨å…ˆéªŒä¸ºé«˜æ–¯ã€ä¼¼ç„¶ä¸ºæ¡ä»¶ç‹¬ç«‹æƒ…å½¢ä¸‹ï¼Œè¿™ä¸ª Hessian å¯ä»¥å¾ˆå¥½åœ°è¢« Fisher ä¿¡æ¯çŸ©é˜µè¿‘ä¼¼**ï¼Œä»è€Œä½¿å¾—ï¼š
$$
\Sigma^{-1} \approx \mathcal{F}(\theta^*)
$$
è¿™ä¸€éƒ¨åˆ†ä¹Ÿå°±æ˜¯ EWCä¸­æåˆ°çš„ ä½¿ç”¨Finsheä¿¡æ¯çŸ©é˜µæ¥è¿‘ä¼¼ HessiançŸ©é˜µã€‚



## Finsher ä¿¡æ¯çŸ©é˜µçš„å¯¹è§’è¿‘ä¼¼

è®¡ç®—å®Œæ•´çš„ Hessian æ˜¯éå¸¸è€—è´¹è®¡ç®—èµ„æºçš„ï¼Œç‰¹åˆ«æ˜¯åœ¨ç¥ç»ç½‘ç»œä¸­ã€‚æ‰€ä»¥æˆ‘ä»¬è¿›ä¸€æ­¥ç®€åŒ–ï¼Œå°†å…¶**è¿‘ä¼¼ä¸º Fisher ä¿¡æ¯çŸ©é˜µçš„å¯¹è§’å½¢å¼**ï¼š

### Fisher ä¿¡æ¯çŸ©é˜µï¼ˆå¯¹è§’è¿‘ä¼¼ï¼‰ï¼š

$$
F_i = \mathbb{E}_{x \sim D_A} \left[ \left( \frac{\partial \log p(y|x, \theta)}{\partial \theta_i} \right)^2 \right]
$$

è¿™ä¸ªè¿‘ä¼¼æœ‰ä¸‰ä¸ªä¼˜ç‚¹ï¼š

1. **åªç”¨ä¸€é˜¶å¯¼æ•°ï¼ˆæ¢¯åº¦ï¼‰å³å¯è®¡ç®—**ï¼Œä¸éœ€è¦æ˜‚è´µçš„äºŒé˜¶å¯¼ï¼›
2. **ä¸æŸå¤±å‡½æ•°çš„äºŒé˜¶å¯¼æ•°åœ¨æå€¼ç‚¹é™„è¿‘æ˜¯ç­‰ä»·çš„**ï¼›
3. æ˜¯ä¸€ä¸ª **æ­£å®šçŸ©é˜µ**ï¼Œå¤©ç„¶å¯ä»¥æ„é€ æ¦‚ç‡åˆ†å¸ƒã€‚

å› æ­¤ï¼Œæˆ‘ä»¬ç”¨å¯¹è§’åŒ–çš„ Fisher ä¿¡æ¯çŸ©é˜µæ¥è¿‘ä¼¼Hessian çŸ©é˜µ

### é«˜æ–¯è¿‘ä¼¼åéªŒï¼ˆEWC ä¸­çš„è¡¨è¾¾ï¼‰ï¼š

$p(\theta | D_A) \approx \mathcal{N}(\theta^*_A, \text{diag}(F)^{-1})$

è¿™æ„å‘³ç€ï¼š

- æ¯ä¸ªå‚æ•° $\theta_i$ çš„æ–¹å·®è¿‘ä¼¼ä¸º $\sigma_i^2 = 1 / F_i$ï¼›
- å‚æ•° $\theta_i$ è¶Šé‡è¦ï¼ˆå³ $F_i$ è¶Šå¤§ï¼‰ï¼Œæˆ‘ä»¬å¯¹å®ƒçš„ä¸ç¡®å®šæ€§å°±è¶Šå°ï¼ˆæ–¹å·®è¶Šå°ï¼‰ï¼›
- åç»­å­¦ä¹ ï¼ˆä¾‹å¦‚ä»»åŠ¡ Bï¼‰åº”å°½å¯èƒ½é¿å…æ”¹å˜è¿™ç±»é‡è¦å‚æ•°ã€‚



## ğŸ“Œ å…­ã€æ€»ç»“è¦ç‚¹

- Fisher ä¿¡æ¯çŸ©é˜µåº¦é‡äº†**å‚æ•°å¯¹æ•°æ®åˆ†å¸ƒçš„æ•æ„Ÿæ€§**ï¼›
- å®ƒæ˜¯å¯¹**æŸå¤±å‡½æ•°æ›²ç‡ï¼ˆHessianï¼‰çš„æœŸæœ›è¿‘ä¼¼**ï¼›
- åœ¨æå¤§ä¼¼ç„¶ä¼°è®¡ä¸­ï¼Œå®ƒç»™å‡ºå‚æ•°ä¼°è®¡çš„**æ–¹å·®ä¸‹ç•Œ**ï¼ˆCramÃ©r-Rao boundï¼‰ï¼›
- åœ¨è´å¶æ–¯ä¼°è®¡ä¸­ï¼Œå®ƒå¯ä»¥ç”¨æ¥**è¿‘ä¼¼åéªŒåˆ†å¸ƒçš„åæ–¹å·®**ï¼Œç”¨äºæ‹‰æ™®æ‹‰æ–¯è¿‘ä¼¼ï¼›
- åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œå®ƒè¢«å¹¿æ³›ç”¨äºï¼š**è‡ªç„¶æ¢¯åº¦ä¸‹é™ï¼ˆNGDï¼‰**ã€**å¼¹æ€§æƒé‡å·©å›ºï¼ˆEWCï¼‰**ã€**è´å¶æ–¯ç¥ç»ç½‘ç»œä¸­çš„ä¸ç¡®å®šæ€§ä¼°è®¡**ç­‰ã€‚
